* calculating rms of the backbone
*
bomlev -1
open read unit 1 card name top.inp
read rtf card unit 1

open read unit 1 card name par.inp
read param card unit 1

open read card unit 1 name .psf
read psf card unit 1

! Use the same .crd file as in prot-rms.charmm.inp 
open read card unit 3 name .crd
read coor card unit 3

open read unit 1 file name prod.dcd
trajectory iread 1 nread 1 skip 100 

open write unit 10 form name bbone-rms.dat
write title unit 10
*#RMS diff of the backbone
*
	
set 1 0
label loop
  traj read comp
  DEFINE bbone SELE segi 1BPI .and. - 
               (type ca .or. type c .or. type n .or. type o) END
  COOR ORIE MASS RMS sele bbone end
  incr 1 by 1
  write title unit 10
* @1 ?rms
*
if 1 lt 	499.5 goto loop

stop
